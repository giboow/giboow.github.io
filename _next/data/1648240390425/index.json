{"pageProps":{"edito":null,"posts":[{"id":"postgresql-optim-requete-geoloc","contentHtml":"<p>R√©cemment j‚Äôai voulu cr√©er une petite application mobile qui permet de rechercher les bo√Ætes aux lettres qui sont autour de la g√©olocalisation utilisateur. D‚Äôautres apps existent, mais leurs performances n‚Äô√©taient pas vraiment au rendez-vous, alors j‚Äôai voulu tenter de trouver des solutions!</p>\n<p>Pour commencer, j‚Äôai r√©ussi √† r√©cup√©rer un jeu de donn√©e sur le site <a href=\"http://data.gouv.fr/\">data.gouv.fr</a> : <a href=\"https://www.data.gouv.fr/fr/datasets/liste-des-boites-aux-lettres-de-rue-france-metropolitaine-et-dom-avec-heure-limite-de-depot-1/\">https://www.data.gouv.fr/fr/datasets/liste-des-boites-aux-lettres-de-rue-france-metropolitaine-et-dom-avec-heure-limite-de-depot-1/</a> . Ce jeu de donn√©es comporte 140 000 entr√©es, bien s√ªr l‚Äôutilisateur qui va vouloir afficher les bo√Ætes aux lettres proches de lui, n‚Äôaura pas besoin d‚Äôafficher toutes les bo√Ætes disponibles dans la base de donn√©es, mais seulement celles proches de lui, par exemple 10km.</p>\n<p>Pour mon projet j‚Äôutilise une API SpringBoot, mais ce n‚Äôest pas ce qui va vous int√©resser aujourd‚Äôhui. Le vrai probl√®me c‚Äôest comment r√©cup√©rer l‚Äôensemble des donn√©es, stock√©es dans une base de donn√©es PostgreSQL, qui sont g√©olocalis√©es proche d‚Äôun point dans un temps convenable!</p>\n<h2>L‚Äôobjectif</h2>\n<p>Mon objectif est donc de trouver un ensemble de points qui se trouvent dans un rayon de 10km, en un temps record!</p>\n<p><img src=\"/static/images/post/postgres-geoloc-optim.png\" alt=\"Objectif de la requete\"></p>\n<h2>PostGIS √† la rescousse</h2>\n<p>PostGIS est une extension de PostgreSQL, elle permet d‚Äôoffrir de nouvelle fonction et des types de donn√©es qui facilitent les recherches g√©olocalis√©es.</p>\n<p>Pour installer PostGIS sur son serveur :</p>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">~$ <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> postgis\n</code></pre></div>\n<p>Il faut ensuite l‚Äôactiver dans PosgresSQL, en se connectant √† la base de donn√©es et en ajoutant l‚Äôextension <strong>postgis</strong>. Elle sera donc active uniquement dans la base de donn√©es s√©lectionn√©e.</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">psql <span class=\"token punctuation\">(</span><span class=\"token number\">13.6</span> <span class=\"token punctuation\">(</span>Ubuntu <span class=\"token number\">13.6</span><span class=\"token operator\">-</span><span class=\"token number\">0</span>ubuntu0<span class=\"token punctuation\">.</span><span class=\"token number\">21.10</span><span class=\"token number\">.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Type</span> <span class=\"token string\">\"help\"</span> <span class=\"token keyword\">for</span> help<span class=\"token punctuation\">.</span>\n\npostgres<span class=\"token operator\">=</span><span class=\"token comment\"># \\c test;</span>\npostgres<span class=\"token operator\">=</span><span class=\"token comment\"># CREATE EXTENSION postgis;</span>\n</code></pre></div>\n<p>Nous pouvons maintenant cr√©er une table qui contient un id, une latitude, une longitude ainsi qu‚Äôun point GPS.  La valeur du SRID <strong>4326</strong>  permet de d√©clarer un point utilisant le syst√®me de r√©f√©rence spatiale g√©ographique.</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">public</span><span class=\"token punctuation\">.</span>test <span class=\"token punctuation\">(</span>\n    id bigserial <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n    lat <span class=\"token keyword\">real</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n    long <span class=\"token keyword\">real</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n    location geography<span class=\"token punctuation\">(</span><span class=\"token keyword\">Point</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>On peut alors facilement ajouter un point en utilisant la requ√™te suivante :</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> test <span class=\"token punctuation\">(</span>lat<span class=\"token punctuation\">,</span> long<span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">,</span>ST_SetSRID<span class=\"token punctuation\">(</span>ST_MakePoint<span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2>Optimisation</h2>\n<p>Pour valider mon optimisation, j‚Äôai ajout√© √† ma table 140 000 lignes de donn√©es g√©olocalis√©es.</p>\n<p>B√™tement j‚Äôai voulu rechercher tous les points qui se trouvaient dans un rayon de moins de 10km avec la fonction <strong>st_distancesphere</strong>.</p>\n<p>Voici la requ√™te que j‚Äôex√©cute pour r√©cup√©rer tous les points GPS dans un rayon de 10km :</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXPLAIN</span><span class=\"token punctuation\">(</span>ANALYSE <span class=\"token punctuation\">,</span> BUFFERS <span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span> st_distancesphere<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>location::<span class=\"token keyword\">geometry</span><span class=\"token punctuation\">,</span>ST_SetSRID<span class=\"token punctuation\">(</span>ST_MakePoint<span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> test t\n<span class=\"token keyword\">WHERE</span>\nst_distancesphere<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>location::<span class=\"token keyword\">geometry</span><span class=\"token punctuation\">,</span>ST_SetSRID<span class=\"token punctuation\">(</span>ST_MakePoint<span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&#x3C;</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>L‚Äôanalyser de requ√™te de PostgeSQL montre bien qu‚Äôaucun index n‚Äôest utilis√© et que la requ√™te prend 463ms pour renvoyer 21 points qui correspondes aux conditions.</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">Gather  <span class=\"token punctuation\">(</span>cost<span class=\"token operator\">=</span><span class=\"token number\">1000.00</span><span class=\"token punctuation\">.</span><span class=\"token number\">.2776968</span><span class=\"token number\">.00</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">47062</span> width<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>actual <span class=\"token keyword\">time</span><span class=\"token operator\">=</span><span class=\"token number\">160.851</span><span class=\"token punctuation\">.</span><span class=\"token number\">.461</span><span class=\"token number\">.391</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">115</span> loops<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  Workers Planned: <span class=\"token number\">1</span>\n  Workers Launched: <span class=\"token number\">1</span>\n  Buffers: shared hit<span class=\"token operator\">=</span><span class=\"token number\">1759</span>\n  <span class=\"token operator\">-</span><span class=\"token operator\">></span>  Parallel Seq Scan <span class=\"token keyword\">on</span> test t  <span class=\"token punctuation\">(</span>cost<span class=\"token operator\">=</span><span class=\"token number\">0.00</span><span class=\"token punctuation\">.</span><span class=\"token number\">.2771261</span><span class=\"token number\">.80</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">27684</span> width<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>actual <span class=\"token keyword\">time</span><span class=\"token operator\">=</span><span class=\"token number\">218.887</span><span class=\"token punctuation\">.</span><span class=\"token number\">.415</span><span class=\"token number\">.046</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">58</span> loops<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">\"        Filter: (st_distance(geography((location)::geometry), '0101000020E6100000A48CB80034C64840F5EC03DA673FF13F'::geography, false) &#x3C; '10000'::double precision)\"</span>\n        <span class=\"token keyword\">Rows</span> Removed <span class=\"token keyword\">by</span> Filter: <span class=\"token number\">70535</span>\n        Buffers: shared hit<span class=\"token operator\">=</span><span class=\"token number\">1759</span>\nPlanning <span class=\"token keyword\">Time</span>: <span class=\"token number\">0.376</span> ms\nJIT:\n  Functions: <span class=\"token number\">8</span>\n<span class=\"token string\">\"  Options: Inlining true, Optimization true, Expressions true, Deforming true\"</span>\n<span class=\"token string\">\"  Timing: Generation 2.485 ms, Inlining 178.841 ms, Optimization 117.797 ms, Emission 56.983 ms, Total 356.106 ms\"</span>\nExecution <span class=\"token keyword\">Time</span>: <span class=\"token number\">463.431</span> ms\n</code></pre></div>\n<p>Nous allons donc cr√©er un index qui va permettre d‚Äôacc√©l√©rer la requ√™te (voir  la doc <a href=\"http://postgis.net/workshops/postgis-intro/indexing.html\">http://postgis.net/workshops/postgis-intro/indexing.html</a>):</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">INDEX</span> test_position_geography_index <span class=\"token keyword\">ON</span> test <span class=\"token keyword\">USING</span> GIST<span class=\"token punctuation\">(</span>geography<span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Mais nous allons avoir une mauvaise surprise, car l‚Äôindex ne fonctionne toujours pas. Apr√®s une recherche rapide, je me suis aper√ßu qu‚Äôil n‚Äôy a que certaines fonctions de PostGIS qui peuvent utiliser l‚Äôindexation (voir la doc ici : <a href=\"http://postgis.net/workshops/postgis-intro/indexing.html#spatially-indexed-functions\">http://postgis.net/workshops/postgis-intro/indexing.html#spatially-indexed-functions</a>).</p>\n<p>Je d√©cide donc d‚Äôutiliser la fonction ST_DWithin qui renvoie un vrai si deux points se trouvent bien √† la distance pass√©e dans le 3e param√®tre.</p>\n<p>Voici donc la requ√™te suivie de l‚Äôanalyse :</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXPLAIN</span><span class=\"token punctuation\">(</span>ANALYSE <span class=\"token punctuation\">,</span> BUFFERS <span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span> st_distancesphere<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>location::<span class=\"token keyword\">geometry</span><span class=\"token punctuation\">,</span>ST_SetSRID<span class=\"token punctuation\">(</span>ST_MakePoint<span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> test t\n<span class=\"token keyword\">WHERE</span>\n   ST_DWithin<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">,</span> ST_SetSRID<span class=\"token punctuation\">(</span>ST_MakePoint<span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span>::geography<span class=\"token punctuation\">,</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">Bitmap Heap Scan <span class=\"token keyword\">on</span> test t  <span class=\"token punctuation\">(</span>cost<span class=\"token operator\">=</span><span class=\"token number\">4.95</span><span class=\"token punctuation\">.</span><span class=\"token number\">.2390</span><span class=\"token number\">.34</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">14</span> width<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>actual <span class=\"token keyword\">time</span><span class=\"token operator\">=</span><span class=\"token number\">1.212</span><span class=\"token punctuation\">.</span><span class=\"token number\">.2</span><span class=\"token number\">.205</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">115</span> loops<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">\"  Filter: st_dwithin(location, '0101000020E6100000A48CB80034C64840F5EC03DA673FF13F'::geography, '10000'::double precision, true)\"</span>\n  <span class=\"token keyword\">Rows</span> Removed <span class=\"token keyword\">by</span> Filter: <span class=\"token number\">200</span>\n  Heap Blocks: exact<span class=\"token operator\">=</span><span class=\"token number\">150</span>\n  Buffers: shared hit<span class=\"token operator\">=</span><span class=\"token number\">188</span>\n  <span class=\"token operator\">-</span><span class=\"token operator\">></span>  Bitmap <span class=\"token keyword\">Index</span> Scan <span class=\"token keyword\">on</span> test_position_geography_index  <span class=\"token punctuation\">(</span>cost<span class=\"token operator\">=</span><span class=\"token number\">0.00</span><span class=\"token punctuation\">.</span><span class=\"token number\">.4</span><span class=\"token number\">.95</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">72</span> width<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>actual <span class=\"token keyword\">time</span><span class=\"token operator\">=</span><span class=\"token number\">0.288</span><span class=\"token punctuation\">.</span><span class=\"token number\">.0</span><span class=\"token number\">.288</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">315</span> loops<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">\"        Index Cond: (location &#x26;&#x26; _st_expand('0101000020E6100000A48CB80034C64840F5EC03DA673FF13F'::geography, '10000'::double precision))\"</span>\n        Buffers: shared hit<span class=\"token operator\">=</span><span class=\"token number\">26</span>\nPlanning <span class=\"token keyword\">Time</span>: <span class=\"token number\">0.446</span> ms\nExecution <span class=\"token keyword\">Time</span>: <span class=\"token number\">2.288</span> ms\n</code></pre></div>\n<p>On voit bien que l‚Äôindex <strong>test_position_geography_index</strong> est utilis√© et qu‚Äôil permet de r√©cup√©rer les 21 points en <strong>2.288ms</strong> ü§Ø. ****Le gain est √©norme, il permet de r√©duire consid√©rablement le temps d‚Äôex√©cution et le temps d‚Äôutilisation processeur.</p>\n<h2>Bilan</h2>\n<p>Dans mon API de g√©olocalisation de bo√Ætes aux lettres, cela m‚Äôa permis de diviser par 10 le temps de requ√™te et de soulager le serveur lorsque je simulais une charge serveur avec l‚Äôoutil de tests de performance d‚ÄôApache <strong>ab</strong> (<a href=\"https://httpd.apache.org/docs/2.4/fr/programs/ab.html\">https://httpd.apache.org/docs/2.4/fr/programs/ab.html</a>).</p>\n","author":"giboow","title":"PostgreSQL - Comment booster ses recherches de point g√©olocalis√©","date":"2022-03-24","keywords":["PostgreSQL","PostGIS","Latitude","Longitude","Optimisation","SQL"],"image":"/static/images/post/postgres-geoloc-optim.png","summary":"R√©cemment j‚Äôai voulu cr√©er une petite application mobile qui permet de rechercher les bo√Ætes aux lettres qui sont autour de la g√©olocalisation utilisateur. D‚Äôautres apps existent, mais leurs performances n‚Äô√©taient pas vraiment au rendez-vous, alors j‚Äôai voulu tenter de trouver des solutions","readingTime":4},{"id":"springboot-contrextualiser-la-serialization","contentHtml":"<p>√Ä chaque fois que j‚Äôai d√©velopp√© une API, je me suis confront√© au m√™me probl√®me : comment filtrer les donn√©es en fonction de mes appels API.</p>\n<p>En effet, certains appels qui sont disponibles par exemple pour appel ‚Äúutilisateur‚Äù ne rendront pas les m√™mes donn√©es qu‚Äôun appel disponible pour un ‚Äúadministrateur‚Äù.</p>\n<h1>Le projet</h1>\n<p>Pour commencer, nous allons construire une API REST pour la gestion des v√©hicules, nous aurons donc un objet ‚Äú<strong>Vehicle‚Äù</strong> qui sera constitu√© de la fa√ßon suivante :</p>\n<ul>\n<li>Id: Long</li>\n<li>brand: String ‚áí La marque, par exemple (Renault)</li>\n<li>model: String ‚áí Le model, par exemple (Megane)</li>\n<li>registrationPlate: String  ‚áí La plaque d‚Äôimmatriculation de la voiture, par exemple (SP-800-TT)</li>\n<li>Serial number : String ‚áí Le num√©ro de s√©rie du v√©hicule</li>\n</ul>\n<p>Ces donn√©es pourront √™tre lues par n‚Äôimporte quel utilisateur. Nous d√©finirons en plus des donn√©es dont l‚Äôutilisateur n‚Äôa pas besoin, mais que l‚Äôadministrateur peut consulter :</p>\n<ul>\n<li>CreatedAt : LocalDatetime ‚áí Date de cr√©ation de l‚Äôobjet en base de donn√©es</li>\n<li>UpdatedAt : LocalDatetime ‚áí Date de modification de l‚Äôobjet en base de donn√©es</li>\n</ul>\n<p>Pour gagner du temps lors de mes d√©veloppements, je d√©finis une Class abstraite qui me sert de base a l‚Äôensemble de mes entit√©s :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@MappedSuperclass</span>\n<span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token annotation punctuation\">@SuperBuilder</span>\n<span class=\"token annotation punctuation\">@NoArgsConstructor</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">EntityAbstract</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@CreatedDate</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"timestamp default now()\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span>access <span class=\"token operator\">=</span> <span class=\"token class-name\">JsonProperty<span class=\"token punctuation\">.</span>Access</span><span class=\"token punctuation\">.</span>READ_ONLY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonFormat</span><span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token class-name\">JsonFormat<span class=\"token punctuation\">.</span>Shape</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">,</span> pattern<span class=\"token operator\">=</span><span class=\"token string\">\"yyyy-MM-dd'T'HH:mm:ss'Z'\"</span><span class=\"token punctuation\">,</span> timezone<span class=\"token operator\">=</span><span class=\"token string\">\"UTC\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">LocalDateTime</span> createdAt<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@LastModifiedDate</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"timestamp default now()\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span>access <span class=\"token operator\">=</span> <span class=\"token class-name\">JsonProperty<span class=\"token punctuation\">.</span>Access</span><span class=\"token punctuation\">.</span>READ_ONLY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonFormat</span><span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token class-name\">JsonFormat<span class=\"token punctuation\">.</span>Shape</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">,</span> pattern<span class=\"token operator\">=</span><span class=\"token string\">\"yyyy-MM-dd'T'HH:mm:ss'Z'\"</span><span class=\"token punctuation\">,</span> timezone<span class=\"token operator\">=</span><span class=\"token string\">\"UTC\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">LocalDateTime</span> updatedAt<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Puis je d√©finis ma classe Vehicle :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Vehicle</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">EntityAbstract</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> registrationPlate<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> model<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> brand<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> serialNumber<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Enfin nous d√©finirons un Controller qui permettra d‚Äôacc√©der aux donn√©es √† l‚Äôaide d‚Äôun service de r√©cup√©ration des donn√©es avec une route utilisateur ainsi qu‚Äôune route Admin :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RestController</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">VehicleController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">VehicleService</span> vehicleService<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/vehicle/list\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&#x3C;</span><span class=\"token class-name\">Vehicle</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/vehicle/list\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&#x3C;</span><span class=\"token class-name\">Vehicle</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">adminListVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Pour le moment, le rendu des donn√©es est exactement le m√™me, mais nous allons voir par la suite comment ‚Äúfilter‚Äù les donn√©es.</p>\n<h1>Jackson √† la rescousse!</h1>\n<p>Pour filtrer les donn√©es, nous allons utiliser une fonctionnalit√© de la librairie Jackson, les JsonView!</p>\n<p>Nous devons d√©finir une classe contenant des interfaces qui correspondent aux niveau des filtres de notre API :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\"> * Json view filter</span>\n<span class=\"token doc-comment comment\"> */</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JsonViews</span> <span class=\"token punctuation\">{</span>\n\t  <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Create</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Update</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Create</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Summary</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Update</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Admin</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Summary</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Le niveau ‚Äú<strong>Create‚Äù</strong> correspond aux attributs visibles pour la cr√©ation d‚Äôun objet, ‚Äú<strong>Update‚Äù</strong> √©tend du filtre pr√©c√©dent et permettra de filtrer uniquement les attributs qui peuvent √™tre mis √† jour. <strong>‚ÄúSummary‚Äù,</strong> √©tend des propri√©t√© de <strong>‚ÄúCreate‚Äù</strong> et <strong>‚ÄùUpdate‚Äù.</strong> Enfin ‚Äú<strong>Admin‚Äù</strong> permet de visualiser ou de mettre √† jour des attributs uniquement accessibles aux Administrateurs.</p>\n<p>Cette fonctionnalit√© sert non seulement au rendu d‚Äôun JSON, que lorsque l‚ÄôAPI consomme le Body d‚Äôune requ√™te.</p>\n<p>Nous allons mettre √† jour l‚Äôentit√© pour que les attributs soient filtr√©s correctement par l‚ÄôAPI :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@MappedSuperclass</span>\n<span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token annotation punctuation\">@SuperBuilder</span>\n<span class=\"token annotation punctuation\">@NoArgsConstructor</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">EntityAbstract</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy<span class=\"token operator\">=</span><span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>AUTO<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Update</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Integer</span> id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@CreatedDate</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"timestamp default CURRENT_TIMESTAMP\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span>access <span class=\"token operator\">=</span> <span class=\"token class-name\">JsonProperty<span class=\"token punctuation\">.</span>Access</span><span class=\"token punctuation\">.</span>READ_ONLY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonFormat</span><span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token class-name\">JsonFormat<span class=\"token punctuation\">.</span>Shape</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">,</span> pattern<span class=\"token operator\">=</span><span class=\"token string\">\"yyyy-MM-dd'T'HH:mm:ss'Z'\"</span><span class=\"token punctuation\">,</span> timezone<span class=\"token operator\">=</span><span class=\"token string\">\"UTC\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Admin</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">LocalDateTime</span> createdAt<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@LastModifiedDate</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"timestamp default CURRENT_TIMESTAMP\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span>access <span class=\"token operator\">=</span> <span class=\"token class-name\">JsonProperty<span class=\"token punctuation\">.</span>Access</span><span class=\"token punctuation\">.</span>READ_ONLY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonFormat</span><span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token class-name\">JsonFormat<span class=\"token punctuation\">.</span>Shape</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">,</span> pattern<span class=\"token operator\">=</span><span class=\"token string\">\"yyyy-MM-dd'T'HH:mm:ss'Z'\"</span><span class=\"token punctuation\">,</span> timezone<span class=\"token operator\">=</span><span class=\"token string\">\"UTC\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Admin</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">LocalDateTime</span> updatedAt<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Vehicle</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">EntityAbstract</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Create</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> registrationPlate<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Create</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> model<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Create</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> brand<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Create</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> serialNumber<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Enfin nous pouvons l‚Äôutiliser dans le controller :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RestController</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">VehicleController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">VehicleService</span> vehicleService<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\">     * List v√©hicles</span>\n<span class=\"token doc-comment comment\">     */</span>\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/vehicle/list\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Summary</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&#x3C;</span><span class=\"token class-name\">Vehicle</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\">     * List vehicles (Admin)</span>\n<span class=\"token doc-comment comment\">     */</span>\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/vehicle/list\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Summary</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&#x3C;</span><span class=\"token class-name\">Vehicle</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">adminListVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\">     * Create vehicle (Admin)</span>\n<span class=\"token doc-comment comment\">     */</span>\n    <span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/vehicle\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Admin</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Vehicle</span> <span class=\"token function\">postAdminVehicle</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Create</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Vehicle</span> vehicle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">createVehicle</span><span class=\"token punctuation\">(</span>vehicle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\">     * Update vehicle (Admin)</span>\n<span class=\"token doc-comment comment\">     */</span>\n    <span class=\"token annotation punctuation\">@PutMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/vehicle\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Admin</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Vehicle</span> <span class=\"token function\">putAdminVehicle</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Update</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Vehicle</span> vehicle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">updateVehicle</span><span class=\"token punctuation\">(</span>vehicle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h1>R√©sultat</h1>\n<h2>Liste des v√©hicules (Vue utilisateur)</h2>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">~ <span class=\"token function\">curl</span> http://localhost:8080/vehicle/list\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:1,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-205-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"205\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"3KX9YLH2K980HNYYS1YZ\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:2,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-206-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"206\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VST52ASAH145TIZGJ3LC\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:3,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-207-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"207\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"JI0BNW8D1HYGPFAECEPJ\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:4,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-208-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"208\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"LN97FF02UWRJYRAEGFL5\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:5,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-106-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"106\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"R94DJ8P5PT7M6PB5DP5B\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:6,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-107-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"107\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"OJHHEW2SP2KJDU3CZLFO\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:7,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-108-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"108\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"49LUMOTWMOQSNHK09MR3\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:8,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-306-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"306\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"0KBBBHVTZN9P66I8TVGT\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:9,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-307-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"307\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"TK0GX92MY29AR0H9ZYIB\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:10,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-308-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"308\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"EKNPA002KCQXYAUX04AV\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:11,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-309-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"309\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"D1788D08RU0AU3O5BVXR\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:12,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-405-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"405\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PHU0M7NKZ799D64VBVJ8\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:13,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-406-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"406\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"NAD3F2ULL5TY4QCECLAO\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:14,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-407-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"407\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"C842THXCOBFFZ0O5U0YK\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:15,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-508-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"508\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"F0T2ELSQ0VPRF1NBY8XH\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:16,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-407-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"407\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"WEBVP95ON3HDX0TGPFXB\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:17,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-508-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"508\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"TEZ3D70UDBY8UKHRKSYY\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:18,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-605-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"605\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"WIGYNFTWH0Q6E85Z2HA2\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:19,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-607-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"607\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"OLI3JCTF82WUQK14Z295\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n</code></pre></div>\n<h2>Liste des V√©hicules (Vue Admin)</h2>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">~ <span class=\"token function\">curl</span> http://localhost:8080/admin/vehicle/list\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:1,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-205-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"205\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"3KX9YLH2K980HNYYS1YZ\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:2,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-206-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"206\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VST52ASAH145TIZGJ3LC\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:3,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-207-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"207\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"JI0BNW8D1HYGPFAECEPJ\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:4,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-208-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"208\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"LN97FF02UWRJYRAEGFL5\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:5,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-106-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"106\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"R94DJ8P5PT7M6PB5DP5B\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:6,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-107-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"107\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"OJHHEW2SP2KJDU3CZLFO\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:7,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-108-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"108\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"49LUMOTWMOQSNHK09MR3\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:8,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-306-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"306\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"0KBBBHVTZN9P66I8TVGT\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:9,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-307-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"307\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"TK0GX92MY29AR0H9ZYIB\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:10,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-308-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"308\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"EKNPA002KCQXYAUX04AV\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:11,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-309-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"309\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"D1788D08RU0AU3O5BVXR\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:12,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-405-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"405\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PHU0M7NKZ799D64VBVJ8\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:13,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-406-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"406\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"NAD3F2ULL5TY4QCECLAO\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:14,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-407-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"407\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"C842THXCOBFFZ0O5U0YK\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:15,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-508-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"508\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"F0T2ELSQ0VPRF1NBY8XH\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:16,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-407-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"407\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"WEBVP95ON3HDX0TGPFXB\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:17,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-508-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"508\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"TEZ3D70UDBY8UKHRKSYY\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:18,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-605-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"605\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"WIGYNFTWH0Q6E85Z2HA2\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:19,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-607-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"607\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"OLI3JCTF82WUQK14Z295\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n</code></pre></div>\n<h2>Cr√©ation de v√©hicule</h2>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">~ <span class=\"token function\">curl</span> --location --request POST <span class=\"token string\">'localhost:8080/admin/vehicle'</span> <span class=\"token punctuation\">\\</span>\n--header <span class=\"token string\">'Content-Type: application/json'</span> <span class=\"token punctuation\">\\</span>\n--data-raw <span class=\"token string\">'{</span>\n<span class=\"token string\">    \"brand\": \"VolksWagen\",</span>\n<span class=\"token string\">    \"model\": \"Golf\",</span>\n<span class=\"token string\">    \"serialNumber\": \"VWVWVWVWVWVWVW\",</span>\n<span class=\"token string\">    \"registrationPlate\": \"GO-123-LF\"</span>\n<span class=\"token string\">}'</span>\n<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:20,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T15:34:03Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T15:34:03Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"GO-123-LF\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"Golf\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VolksWagen\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VWVWVWVWVWVWVW\"</span><span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2>Mise a jour de v√©hicule</h2>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">~ <span class=\"token function\">curl</span> --location --request PUT <span class=\"token string\">'localhost:8080/admin/vehicle'</span> <span class=\"token punctuation\">\\</span>\n--header <span class=\"token string\">'Content-Type: application/json'</span> <span class=\"token punctuation\">\\</span>\n--data-raw <span class=\"token string\">'{</span>\n<span class=\"token string\">    \"id\": 20,</span>\n<span class=\"token string\">    \"brand\": \"VolksWagen\",</span>\n<span class=\"token string\">    \"model\": \"Golf SW\",</span>\n<span class=\"token string\">    \"serialNumber\": \"VWVWVWVWVWVWVW\",</span>\n<span class=\"token string\">    \"registrationPlate\": \"GO-123-LF\"</span>\n<span class=\"token string\">}'</span>\n<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:20,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T15:40:55Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T15:40:55Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"GO-123-LF\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"Golf SW\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VolksWagen\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VWVWVWVWVWVWVW\"</span><span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Vous pouvez retrouver le github du projet ici : <a href=\"https://dev.to/giboow/springboot-contextualizing-serialization-29mp\">https://dev.to/giboow/springboot-contextualizing-serialization-29mp</a></p>\n<p>Cr√©dit photo : https://unsplash.com/photos/WVl1N2C2zEA</p>\n","author":"giboow","title":"SpringBoot -  Contextualiser la serialisation","date":"2022-02-28","keywords":["SpringBoot","API","JSON","Jackson","Filter"],"image":"/static/images/post/tyler-nix-WVl1N2C2zEA-unsplash.jpg","summary":"√Ä chaque fois que j‚Äôai d√©velopp√© une API, je me suis confront√© au m√™me probl√®me : comment filtrer les donn√©es","readingTime":4},{"id":"comment-transcoder-une-video-avec-springboot-et-ffmpeg","contentHtml":"<p>J'ai r√©cemment commenc√© √† travailler sur un syst√®me de cam√©ras de surveillance et je souhaite pouvoir afficher les vid√©os collect√©es sur des pages Web.\n√Ä premi√®re vue, cela semblait tr√®s facile, mais je me suis vite rendu compte que je devais me creuser la t√™te!</p>\n<h1>Comment cela doit fonctionner?</h1>\n<p>La cam√©ra est connect√©e √† un NVR (Numeric Video recorder) qui poss√®de une API permettant de r√©cup√©rer les informations de configuration et le flux vid√©o. En cherchant un peu sur le Web (Oui la documentation est difficile d'acc√®s..), je d√©couvre que le protocole de communication utilis√© par le NVR est le RTSP (Real-Time Streaming Protocol). C'est l√† que je rencontre le principal probl√®me ! Comment utiliser ce protocole dans une page HTML qui ne le supporte pas ? Ma solution est d'utiliser un serveur qui permet de transcoder la vid√©o dans un format plus connu (MP4) et un protocole ultra standard (Http). Cela me permettra √©galement de cacher les identifiants d'acc√®s √† la cam√©ra en utilisant mon serveur comme un proxy.</p>\n<p><img src=\"https://giboow.fr/static/images/post/proxy-transcoder-ffmpeg/graph-ffmpeg-transcoder.png\" alt=\"Graph it should work\"></p>\n<h1>Alors comment on fait √ßa?</h1>\n<p>Un excellent outil bien connu pour faire de la conversion vid√©o est <a href=\"https://www.ffmpeg.org/\">FFMPeg</a>, donc je commence √† regarder comment je peux l'utiliser pour convertir RSTP. Je trouve rapidement une ligne de commande qui fonctionne :</p>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -y -loglevel level+info -n -re -acodec pcm_s16le -rtsp_transport tcp -i rtsp://user:passwd@192.168.1.200:554/ISAPI/Streaming/channels/101/live -vcodec copy -af <span class=\"token assign-left variable\">asetrate</span><span class=\"token operator\">=</span><span class=\"token number\">22050</span> -acodec aac -b:a 96k -nostdin myvideo.mp4\n</code></pre></div>\n<p>Alors comment faire un proxy avec SpringBoot ? C'est tr√®s simple en fait, il suffit d'utiliser l'objet <a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/mvc/method/annotation/StreamingResponseBody.html\">StreamingResponseBody</a>. Cela permet de renvoyer un traitement asynchrone de la requ√™te, o√π l'application peut √©crire directement sur le flux de sortie de la r√©ponse sans bloquer le reste de mon API.</p>\n<p>Enfin, il me suffit d'utiliser FFMPEG dans mon contr√¥leur pour envoyer le flux via mon API. J'aurais pu utiliser \" Runtime.getRuntime().exec(\" ffmpeg...) \" mais je n'arrivais pas √† trouver comment obtenir mon flux. Heureusement, j'ai trouv√© une biblioth√®que magique <a href=\"https://github.com/kokorin/Jaffree\">Jaffree</a> : \"Jaffree stands for JAva FFmpeg and FFprobe FREE command line wrapper. Jaffree supports programmatic video production and consumption (with transparency)\"</p>\n<h1>La solution</h1>\n<p>Voici la solution finale et comment relayer un flux vid√©o provenant d'une cam√©ra HikVision afin que le format soit utilisable par une page HTML.</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>kokorin<span class=\"token punctuation\">.</span>jaffree<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamType</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>kokorin<span class=\"token punctuation\">.</span>jaffree<span class=\"token punctuation\">.</span>ffmpeg<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">FFmpeg</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>kokorin<span class=\"token punctuation\">.</span>jaffree<span class=\"token punctuation\">.</span>ffmpeg<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">PipeOutput</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@RestController</span>\n<span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/video\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@Log4j2</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">VideoController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"/live.mp4\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@ResponseBody</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&#x3C;</span><span class=\"token class-name\">StreamingResponseBody</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">livestream</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@PathVariable</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> tipperId<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token class-name\">String</span> rtspUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"rtsp://user:passwd@192.168.1.200:554/ISAPI/Streaming/channels/101/live\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token punctuation\">.</span><span class=\"token function\">ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">contentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span>APPLICATION_OCTET_STREAM<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">body</span><span class=\"token punctuation\">(</span>os <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token class-name\">FFmpeg</span><span class=\"token punctuation\">.</span><span class=\"token function\">atPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArgument</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-re\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-acodec\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pcm_s16le\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-rtsp_transport\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tcp\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-i\"</span><span class=\"token punctuation\">,</span> $rtspUrl<span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-vcodec\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"copy\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-af\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"asetrate=22050\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-acodec\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"aac\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-b:a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"96k\"</span> <span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addOutput</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PipeOutput</span><span class=\"token punctuation\">.</span><span class=\"token function\">pumpTo</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">disableStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamType</span><span class=\"token punctuation\">.</span>AUDIO<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">disableStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamType</span><span class=\"token punctuation\">.</span>SUBTITLE<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">disableStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamType</span><span class=\"token punctuation\">.</span>DATA<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">setFrameCount</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamType</span><span class=\"token punctuation\">.</span>VIDEO<span class=\"token punctuation\">,</span> <span class=\"token number\">100L</span><span class=\"token punctuation\">)</span>\n                                     <span class=\"token comment\">//1 frame every 10 seconds</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">setFrameRate</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">setDuration</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">TimeUnit</span><span class=\"token punctuation\">.</span>HOURS<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">setFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ismv\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArgument</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-nostdin\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Vous devrez √©galement modifier la configuration de votre application SpringBoot (fichier application.properties) pour augmenter le d√©lai d'attente pour les requ√™tes asynchrones.</p>\n<div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\">spring.mvc.async.request-timeout = 3600000\n</code></pre></div>\n<p>Il vous suffit d'appeler votre API sur la page web :</p>\n<div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>video<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>video</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100%<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>auto<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">controls</span> <span class=\"token attr-name\">autoplay</span> <span class=\"token attr-name\">muted</span> <span class=\"token attr-name\">loop</span> <span class=\"token attr-name\">*ngIf</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>event?.video<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://localhost:8080/video/live.mp4<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>video/mp4<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    Sorry, your browser doesn't support embedded videos.\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;/</span>video</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;/</span>div</span><span class=\"token punctuation\">></span></span>\n</code></pre></div>\n<p>Et voici le r√©sultat :</p>\n<p><img src=\"https://giboow.fr/static/images/post/proxy-transcoder-ffmpeg/result-ffmpeg-transcoder.png\" alt=\"Final result\"></p>\n<p>Facile non?</p>\n<p><a href=\"https://dev.to/giboow/how-to-build-a-video-transcoder-with-springboot-and-ffmpeg-n7p\">Retrouvez l'article anglais sur dev.to</a></p>\n","author":"giboow","title":"Comment construire un transcodeur vid√©o avec SpringBoot et FFMPEG !","date":"2021-10-12","keywords":["Video","Transcoder","SpringBoot","FFMpeg","Java"],"image":"/static/images/post/proxy-transcoder-ffmpeg/main.jpg","summary":"J'ai r√©cemment commenc√© √† travailler sur un syst√®me de cam√©ras de surveillance et je souhaite pouvoir afficher les vid√©os collect√©es sur des pages Web. √Ä premi√®re vue, cela semblait tr√®s facile...","readingTime":3},{"id":"android-emulator-apple-silicon","contentHtml":"<p>Bonsoir √† tous!</p>\n<p>J'ai r√©cemment craqu√© pour le nouveau MacBook Pro M1! Depuis 1 semaine que je l'apprivoise, toutes les applications\nque j'utilise fonctionnent (merci Rosetta2!). Mon seul probl√®me, en tant que developpeur mobile, est que l'Emulateur\nAndroid ne fonctionne pas. C'est\nd'ailleurs le probl√®me de toutes les applications qui font de la virtualisation (Docker, ParallelDesktop, etc ‚Ä¶)!\nJe dois donc utiliser un t√©l√©phone physique, et cela m'emp√™che de tester mes applications sur diff√©rentes versions\nd'Android.</p>\n<p>Heureusement les ing√©nieurs de Google sont √† fond sur le  coup et ont mis √† disposition une version Preview de\nl'√©mulateur ici : <a href=\"https://androidstudio.googleblog.com/2020/12/android-emulator-apple-silicon-preview.html\">https://androidstudio.googleblog.com/2020/12/android-emulator-apple-silicon-preview.html</a></p>\n<p>Et √ßa fonctionne :</p>\n<p><img src=\"/static/images/post/capture_android_emulator_preview.png\" alt=\"Capture Android preview\"></p>\n<p>Pour autant tout n'est pas parfait :</p>\n<ul>\n<li>Les Webview ne fonctionnent pas</li>\n<li>Pas de son</li>\n<li>Pas de skin t√©l√©phone</li>\n<li>Les codecs vid√©os ne sont pas fonctionnels</li>\n<li>Les applications ARM 32Bits ne sont pas compatibles</li>\n<li>Quelques bugs graphiques sur les applications utilisant l'API Vulkan</li>\n<li>Une popup apparait au d√©marrage de l'√©mulateur, indiquant qu'elle ne trouve pas ADB</li>\n</ul>\n<p>Tout est dit! Il ne reste plus qu'√† tester üòÉ.</p>\n<p>Amusez-vous bien!</p>\n","author":"giboow","title":"Android Emulator sur Apple Silicon, enfin une preview!","date":"2020-12-06","keywords":["Android","Android Emulator","Apple Silicon","AppleM1"],"image":"/static/images/post/android-apple.png","summary":"J'ai r√©cemment craqu√© pour le nouveau MacBook Pro M1! Depuis 1 semaine que je l'apprivoise, toutes les applications que j'utilise fonctionnent (merci Rosetta2!). Mon seul probl√®me, en tant que developpeur mobile, est que l'Emulateur Android ne fonctionne pas","readingTime":1},{"id":"comment-configurer-postgresql-avec-pgtune","contentHtml":"<p>R√©cemment, j'ai d√ª mettre le nez dans les serveurs de notre application, car nous avions des probl√®mes de performances\net de stabilit√©.</p>\n<p>Pour vous replanter le d√©cor, l'application dont je m'occupe aujourd'hui est h√©berg√© sur un serveur qui comprend un\nservice de base de donn√©es Postgres, un serveur d'application Java, ainsi que d'un serveur apache permettant aux\nutilisateurs de t√©l√©charger le front. Tout √ßa fonctionne sur le m√™me serveur sans conteneurs. N'ayant pas install√© ces\nservices moi-m√™me, j'ai d√ª passer un peu de temps pour comprendre pourquoi notre serveur plantait lors de fortes\ncharges... Puis je me suis aper√ßu gr√¢ce √† notre syst√®me de monitoring que la m√©moire du serveur Postgres n'√©tait m√™me\npas limit√©e...</p>\n<p>Je n'ai aucune connaissance sur les configurations des services Postgres, et comme je n'aime pas trop perdre de temps √†\n√©plucher les documentations, j'ai fouill√© un peu sur la toile. C'est l√† que j'ai d√©couvert le travail\nde <a href=\"https://github.com/le0pard\">Alexey Vasiliev (@leOpard)</a> qui propose un g√©n√©rateur de configuration\nPostgres : <a href=\"https://pgtune.leopard.in.ua/#/\">PGTune</a></p>\n<p>Il suffit de param√©trer votre configuration en fonction des ressources que vous voulez allouer sur le serveur! Et PAF √ßa\nfait le ‚òï!</p>\n<p><img src=\"/static/images/post/capture-pgtune.png\" alt=\"PGTune capture\"></p>\n<p>Il ne vous reste plus qu'√† injecter cette nouvelle configuration dans le fichier de configuration de votre Postgres.</p>\n<p>Depuis que j'ai appliqu√© la configuration par l'utilitaire, je n'ai plus de probl√®me de performance. Finalement, les utilisateurs sont\ncontents, et moi aussi üòÉ.</p>\n<p>Pour les fans de <a href=\"https://www.ruby-lang.org/fr/\">Ruby</a>, o√π si cela vous amuse, vous pouvez aller consulter le code du\ng√©n√©rateur de @leOpard, les sources sont disponibles sur\nGithub : <a href=\"https://github.com/le0pard/pgtune\">https://github.com/le0pard/pgtune</a></p>\n","author":"giboow","title":"Comment bien configurer son serveur Postgres avec PGTune","date":"2020-12-02","keywords":["Postgresql","Tunning","Performances"],"image":"/static/images/post/pgtune.png","summary":"Pr√©sentation d'un outils qui permet de configurer simplement un serveur PostgreSQL","readingTime":2},{"id":"giboow-le-blog","contentHtml":"<p>Je m'appelle Philippe, j'ai 36 ans, j'ai une petite famille ainsi qu'un chat et deux poules!\nJe suis d√©veloppeur d'application depuis une bonne quinzaine d'ann√©es. Le d√©veloppement et la technologie occupent donc\nune bonne partie de mes journ√©es !</p>\n<p>J'ai toujours aim√© la programmation et la logique qui en d√©coule. J'ai commenc√© ma carri√®re au coll√®ge en 4e, lorsque\nmon grand fr√®re m'a offert une calculatrice Casio graphique, depuis ce jour l√† j'ai d√©couvert les bases de la\nprogrammation ! √Ä 13 ans, nous avons re√ßu notre premier ordinateur, c'√©tait un Apple Performa 6320, au bout d‚Äôun mois\nnous avons d√©mont√© la b√™te avec mon fr√®re pour voir comment cela fonctionnait !\nJ'ai ensuite continu√© mon √©volution tranquillement avec des pages HTML statiques, des Apple script, etc...</p>\n<p>Pendant mes\n√©tudes j'ai beaucoup travaill√© sur Linux j'ai donc une bonne connaissance de ce syst√®me et de son fonctionnement, je ne\nsuis cependant pas un expert (mais je me d√©brouille toujours üòÉ).</p>\n<p>En 2009, j'ai commenc√© ma carri√®re professionnelle. J'ai toujours voulu naviguer sur diff√©rents projets, apprendre de\nnouvelles choses. Je d√©teste le fait d'√™tre consid√©r√© comme un expert dans une technologie pr√©cise. J'aime apprendre de\nnouvelles choses, maitriser l'ensemble de mes projets, et de partager mes connaissances avec mes amis, mes coll√®gues,\nvous !</p>\n<p>Sur ce blog con√ßut et r√©aliser avec ‚ô•, je vais essayer de vous partager mon quotidien (du code, du code, du code!!),\nmais aussi tout ce que je trouve int√©ressant sur la toile et relatif a mon m√©tier (application, librairies, hardware,\nnews, etc.) !</p>\n<p>Ce site va √™tre aussi pour moi, un bon moyen pour (re)d√©couvrir ReactJs ainsi que NextJs. J'ai en effet eu l'occasion de\nmanipuler ces deux frameworks, mais sans jamais proposer une version disponible publiquement.</p>\n","author":"giboow","title":"Giboow, le Blog!","date":"2020-11-25","keywords":["Blog","TheBeginning","Objectifs"],"image":"/static/images/post/hello-image.webp","summary":"Je m'appelle Philippe, j'ai 36 ans, j'ai une petite famille ainsi qu'un chat et deux poules! Je suis d√©veloppeur d'application","readingTime":2}]},"__N_SSG":true}