{"pageProps":{"edito":null,"posts":[{"id":"postgresql-optim-requete-geoloc","contentHtml":"<p>Récemment j’ai voulu créer une petite application mobile qui permet de rechercher les boîtes aux lettres qui sont autour de la géolocalisation utilisateur. D’autres apps existent, mais leurs performances n’étaient pas vraiment au rendez-vous, alors j’ai voulu tenter de trouver des solutions!</p>\n<p>Pour commencer, j’ai réussi à récupérer un jeu de donnée sur le site <a href=\"http://data.gouv.fr/\">data.gouv.fr</a> : <a href=\"https://www.data.gouv.fr/fr/datasets/liste-des-boites-aux-lettres-de-rue-france-metropolitaine-et-dom-avec-heure-limite-de-depot-1/\">https://www.data.gouv.fr/fr/datasets/liste-des-boites-aux-lettres-de-rue-france-metropolitaine-et-dom-avec-heure-limite-de-depot-1/</a> . Ce jeu de données comporte 140 000 entrées, bien sûr l’utilisateur qui va vouloir afficher les boîtes aux lettres proches de lui, n’aura pas besoin d’afficher toutes les boîtes disponibles dans la base de données, mais seulement celles proches de lui, par exemple 10km.</p>\n<p>Pour mon projet j’utilise une API SpringBoot, mais ce n’est pas ce qui va vous intéresser aujourd’hui. Le vrai problème c’est comment récupérer l’ensemble des données, stockées dans une base de données PostgreSQL, qui sont géolocalisées proche d’un point dans un temps convenable!</p>\n<h2>L’objectif</h2>\n<p>Mon objectif est donc de trouver un ensemble de points qui se trouvent dans un rayon de 10km, en un temps record!</p>\n<p><img src=\"/static/images/post/postgres-geoloc-optim.png\" alt=\"Objectif de la requete\"></p>\n<h2>PostGIS à la rescousse</h2>\n<p>PostGIS est une extension de PostgreSQL, elle permet d’offrir de nouvelle fonction et des types de données qui facilitent les recherches géolocalisées.</p>\n<p>Pour installer PostGIS sur son serveur :</p>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">~$ <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> postgis\n</code></pre></div>\n<p>Il faut ensuite l’activer dans PosgresSQL, en se connectant à la base de données et en ajoutant l’extension <strong>postgis</strong>. Elle sera donc active uniquement dans la base de données sélectionnée.</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">psql <span class=\"token punctuation\">(</span><span class=\"token number\">13.6</span> <span class=\"token punctuation\">(</span>Ubuntu <span class=\"token number\">13.6</span><span class=\"token operator\">-</span><span class=\"token number\">0</span>ubuntu0<span class=\"token punctuation\">.</span><span class=\"token number\">21.10</span><span class=\"token number\">.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Type</span> <span class=\"token string\">\"help\"</span> <span class=\"token keyword\">for</span> help<span class=\"token punctuation\">.</span>\n\npostgres<span class=\"token operator\">=</span><span class=\"token comment\"># \\c test;</span>\npostgres<span class=\"token operator\">=</span><span class=\"token comment\"># CREATE EXTENSION postgis;</span>\n</code></pre></div>\n<p>Nous pouvons maintenant créer une table qui contient un id, une latitude, une longitude ainsi qu’un point GPS.  La valeur du SRID <strong>4326</strong>  permet de déclarer un point utilisant le système de référence spatiale géographique.</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">public</span><span class=\"token punctuation\">.</span>test <span class=\"token punctuation\">(</span>\n    id bigserial <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n    lat <span class=\"token keyword\">real</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n    long <span class=\"token keyword\">real</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n    location geography<span class=\"token punctuation\">(</span><span class=\"token keyword\">Point</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>On peut alors facilement ajouter un point en utilisant la requête suivante :</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> test <span class=\"token punctuation\">(</span>lat<span class=\"token punctuation\">,</span> long<span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">,</span>ST_SetSRID<span class=\"token punctuation\">(</span>ST_MakePoint<span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2>Optimisation</h2>\n<p>Pour valider mon optimisation, j’ai ajouté à ma table 140 000 lignes de données géolocalisées.</p>\n<p>Bêtement j’ai voulu rechercher tous les points qui se trouvaient dans un rayon de moins de 10km avec la fonction <strong>st_distancesphere</strong>.</p>\n<p>Voici la requête que j’exécute pour récupérer tous les points GPS dans un rayon de 10km :</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXPLAIN</span><span class=\"token punctuation\">(</span>ANALYSE <span class=\"token punctuation\">,</span> BUFFERS <span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span> st_distancesphere<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>location::<span class=\"token keyword\">geometry</span><span class=\"token punctuation\">,</span>ST_SetSRID<span class=\"token punctuation\">(</span>ST_MakePoint<span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> test t\n<span class=\"token keyword\">WHERE</span>\nst_distancesphere<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>location::<span class=\"token keyword\">geometry</span><span class=\"token punctuation\">,</span>ST_SetSRID<span class=\"token punctuation\">(</span>ST_MakePoint<span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&#x3C;</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>L’analyser de requête de PostgeSQL montre bien qu’aucun index n’est utilisé et que la requête prend 463ms pour renvoyer 21 points qui correspondes aux conditions.</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">Gather  <span class=\"token punctuation\">(</span>cost<span class=\"token operator\">=</span><span class=\"token number\">1000.00</span><span class=\"token punctuation\">.</span><span class=\"token number\">.2776968</span><span class=\"token number\">.00</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">47062</span> width<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>actual <span class=\"token keyword\">time</span><span class=\"token operator\">=</span><span class=\"token number\">160.851</span><span class=\"token punctuation\">.</span><span class=\"token number\">.461</span><span class=\"token number\">.391</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">115</span> loops<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  Workers Planned: <span class=\"token number\">1</span>\n  Workers Launched: <span class=\"token number\">1</span>\n  Buffers: shared hit<span class=\"token operator\">=</span><span class=\"token number\">1759</span>\n  <span class=\"token operator\">-</span><span class=\"token operator\">></span>  Parallel Seq Scan <span class=\"token keyword\">on</span> test t  <span class=\"token punctuation\">(</span>cost<span class=\"token operator\">=</span><span class=\"token number\">0.00</span><span class=\"token punctuation\">.</span><span class=\"token number\">.2771261</span><span class=\"token number\">.80</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">27684</span> width<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>actual <span class=\"token keyword\">time</span><span class=\"token operator\">=</span><span class=\"token number\">218.887</span><span class=\"token punctuation\">.</span><span class=\"token number\">.415</span><span class=\"token number\">.046</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">58</span> loops<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">\"        Filter: (st_distance(geography((location)::geometry), '0101000020E6100000A48CB80034C64840F5EC03DA673FF13F'::geography, false) &#x3C; '10000'::double precision)\"</span>\n        <span class=\"token keyword\">Rows</span> Removed <span class=\"token keyword\">by</span> Filter: <span class=\"token number\">70535</span>\n        Buffers: shared hit<span class=\"token operator\">=</span><span class=\"token number\">1759</span>\nPlanning <span class=\"token keyword\">Time</span>: <span class=\"token number\">0.376</span> ms\nJIT:\n  Functions: <span class=\"token number\">8</span>\n<span class=\"token string\">\"  Options: Inlining true, Optimization true, Expressions true, Deforming true\"</span>\n<span class=\"token string\">\"  Timing: Generation 2.485 ms, Inlining 178.841 ms, Optimization 117.797 ms, Emission 56.983 ms, Total 356.106 ms\"</span>\nExecution <span class=\"token keyword\">Time</span>: <span class=\"token number\">463.431</span> ms\n</code></pre></div>\n<p>Nous allons donc créer un index qui va permettre d’accélérer la requête (voir  la doc <a href=\"http://postgis.net/workshops/postgis-intro/indexing.html\">http://postgis.net/workshops/postgis-intro/indexing.html</a>):</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">INDEX</span> test_position_geography_index <span class=\"token keyword\">ON</span> test <span class=\"token keyword\">USING</span> GIST<span class=\"token punctuation\">(</span>geography<span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Mais nous allons avoir une mauvaise surprise, car l’index ne fonctionne toujours pas. Après une recherche rapide, je me suis aperçu qu’il n’y a que certaines fonctions de PostGIS qui peuvent utiliser l’indexation (voir la doc ici : <a href=\"http://postgis.net/workshops/postgis-intro/indexing.html#spatially-indexed-functions\">http://postgis.net/workshops/postgis-intro/indexing.html#spatially-indexed-functions</a>).</p>\n<p>Je décide donc d’utiliser la fonction ST_DWithin qui renvoie un vrai si deux points se trouvent bien à la distance passée dans le 3e paramètre.</p>\n<p>Voici donc la requête suivie de l’analyse :</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXPLAIN</span><span class=\"token punctuation\">(</span>ANALYSE <span class=\"token punctuation\">,</span> BUFFERS <span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span> st_distancesphere<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>location::<span class=\"token keyword\">geometry</span><span class=\"token punctuation\">,</span>ST_SetSRID<span class=\"token punctuation\">(</span>ST_MakePoint<span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> test t\n<span class=\"token keyword\">WHERE</span>\n   ST_DWithin<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">,</span> ST_SetSRID<span class=\"token punctuation\">(</span>ST_MakePoint<span class=\"token punctuation\">(</span><span class=\"token number\">49.548462</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0779799</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4326</span><span class=\"token punctuation\">)</span>::geography<span class=\"token punctuation\">,</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">Bitmap Heap Scan <span class=\"token keyword\">on</span> test t  <span class=\"token punctuation\">(</span>cost<span class=\"token operator\">=</span><span class=\"token number\">4.95</span><span class=\"token punctuation\">.</span><span class=\"token number\">.2390</span><span class=\"token number\">.34</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">14</span> width<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>actual <span class=\"token keyword\">time</span><span class=\"token operator\">=</span><span class=\"token number\">1.212</span><span class=\"token punctuation\">.</span><span class=\"token number\">.2</span><span class=\"token number\">.205</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">115</span> loops<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">\"  Filter: st_dwithin(location, '0101000020E6100000A48CB80034C64840F5EC03DA673FF13F'::geography, '10000'::double precision, true)\"</span>\n  <span class=\"token keyword\">Rows</span> Removed <span class=\"token keyword\">by</span> Filter: <span class=\"token number\">200</span>\n  Heap Blocks: exact<span class=\"token operator\">=</span><span class=\"token number\">150</span>\n  Buffers: shared hit<span class=\"token operator\">=</span><span class=\"token number\">188</span>\n  <span class=\"token operator\">-</span><span class=\"token operator\">></span>  Bitmap <span class=\"token keyword\">Index</span> Scan <span class=\"token keyword\">on</span> test_position_geography_index  <span class=\"token punctuation\">(</span>cost<span class=\"token operator\">=</span><span class=\"token number\">0.00</span><span class=\"token punctuation\">.</span><span class=\"token number\">.4</span><span class=\"token number\">.95</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">72</span> width<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>actual <span class=\"token keyword\">time</span><span class=\"token operator\">=</span><span class=\"token number\">0.288</span><span class=\"token punctuation\">.</span><span class=\"token number\">.0</span><span class=\"token number\">.288</span> <span class=\"token keyword\">rows</span><span class=\"token operator\">=</span><span class=\"token number\">315</span> loops<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">\"        Index Cond: (location &#x26;&#x26; _st_expand('0101000020E6100000A48CB80034C64840F5EC03DA673FF13F'::geography, '10000'::double precision))\"</span>\n        Buffers: shared hit<span class=\"token operator\">=</span><span class=\"token number\">26</span>\nPlanning <span class=\"token keyword\">Time</span>: <span class=\"token number\">0.446</span> ms\nExecution <span class=\"token keyword\">Time</span>: <span class=\"token number\">2.288</span> ms\n</code></pre></div>\n<p>On voit bien que l’index <strong>test_position_geography_index</strong> est utilisé et qu’il permet de récupérer les 21 points en <strong>2.288ms</strong> 🤯. ****Le gain est énorme, il permet de réduire considérablement le temps d’exécution et le temps d’utilisation processeur.</p>\n<h2>Bilan</h2>\n<p>Dans mon API de géolocalisation de boîtes aux lettres, cela m’a permis de diviser par 10 le temps de requête et de soulager le serveur lorsque je simulais une charge serveur avec l’outil de tests de performance d’Apache <strong>ab</strong> (<a href=\"https://httpd.apache.org/docs/2.4/fr/programs/ab.html\">https://httpd.apache.org/docs/2.4/fr/programs/ab.html</a>).</p>\n","author":"giboow","title":"PostgreSQL - Comment booster ses recherches de point géolocalisé","date":"2022-03-24","keywords":["PostgreSQL","PostGIS","Latitude","Longitude","Optimisation","SQL"],"image":"/static/images/post/postgres-geoloc-optim.png","summary":"Récemment j’ai voulu créer une petite application mobile qui permet de rechercher les boîtes aux lettres qui sont autour de la géolocalisation utilisateur. D’autres apps existent, mais leurs performances n’étaient pas vraiment au rendez-vous, alors j’ai voulu tenter de trouver des solutions","readingTime":4},{"id":"springboot-contrextualiser-la-serialization","contentHtml":"<p>À chaque fois que j’ai développé une API, je me suis confronté au même problème : comment filtrer les données en fonction de mes appels API.</p>\n<p>En effet, certains appels qui sont disponibles par exemple pour appel “utilisateur” ne rendront pas les mêmes données qu’un appel disponible pour un “administrateur”.</p>\n<h1>Le projet</h1>\n<p>Pour commencer, nous allons construire une API REST pour la gestion des véhicules, nous aurons donc un objet “<strong>Vehicle”</strong> qui sera constitué de la façon suivante :</p>\n<ul>\n<li>Id: Long</li>\n<li>brand: String ⇒ La marque, par exemple (Renault)</li>\n<li>model: String ⇒ Le model, par exemple (Megane)</li>\n<li>registrationPlate: String  ⇒ La plaque d’immatriculation de la voiture, par exemple (SP-800-TT)</li>\n<li>Serial number : String ⇒ Le numéro de série du véhicule</li>\n</ul>\n<p>Ces données pourront être lues par n’importe quel utilisateur. Nous définirons en plus des données dont l’utilisateur n’a pas besoin, mais que l’administrateur peut consulter :</p>\n<ul>\n<li>CreatedAt : LocalDatetime ⇒ Date de création de l’objet en base de données</li>\n<li>UpdatedAt : LocalDatetime ⇒ Date de modification de l’objet en base de données</li>\n</ul>\n<p>Pour gagner du temps lors de mes développements, je définis une Class abstraite qui me sert de base a l’ensemble de mes entités :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@MappedSuperclass</span>\n<span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token annotation punctuation\">@SuperBuilder</span>\n<span class=\"token annotation punctuation\">@NoArgsConstructor</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">EntityAbstract</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@CreatedDate</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"timestamp default now()\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span>access <span class=\"token operator\">=</span> <span class=\"token class-name\">JsonProperty<span class=\"token punctuation\">.</span>Access</span><span class=\"token punctuation\">.</span>READ_ONLY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonFormat</span><span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token class-name\">JsonFormat<span class=\"token punctuation\">.</span>Shape</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">,</span> pattern<span class=\"token operator\">=</span><span class=\"token string\">\"yyyy-MM-dd'T'HH:mm:ss'Z'\"</span><span class=\"token punctuation\">,</span> timezone<span class=\"token operator\">=</span><span class=\"token string\">\"UTC\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">LocalDateTime</span> createdAt<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@LastModifiedDate</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"timestamp default now()\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span>access <span class=\"token operator\">=</span> <span class=\"token class-name\">JsonProperty<span class=\"token punctuation\">.</span>Access</span><span class=\"token punctuation\">.</span>READ_ONLY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonFormat</span><span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token class-name\">JsonFormat<span class=\"token punctuation\">.</span>Shape</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">,</span> pattern<span class=\"token operator\">=</span><span class=\"token string\">\"yyyy-MM-dd'T'HH:mm:ss'Z'\"</span><span class=\"token punctuation\">,</span> timezone<span class=\"token operator\">=</span><span class=\"token string\">\"UTC\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">LocalDateTime</span> updatedAt<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Puis je définis ma classe Vehicle :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Vehicle</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">EntityAbstract</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> registrationPlate<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> model<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> brand<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> serialNumber<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Enfin nous définirons un Controller qui permettra d’accéder aux données à l’aide d’un service de récupération des données avec une route utilisateur ainsi qu’une route Admin :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RestController</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">VehicleController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">VehicleService</span> vehicleService<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/vehicle/list\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&#x3C;</span><span class=\"token class-name\">Vehicle</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/vehicle/list\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&#x3C;</span><span class=\"token class-name\">Vehicle</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">adminListVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Pour le moment, le rendu des données est exactement le même, mais nous allons voir par la suite comment “filter” les données.</p>\n<h1>Jackson à la rescousse!</h1>\n<p>Pour filtrer les données, nous allons utiliser une fonctionnalité de la librairie Jackson, les JsonView!</p>\n<p>Nous devons définir une classe contenant des interfaces qui correspondent aux niveau des filtres de notre API :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\"> * Json view filter</span>\n<span class=\"token doc-comment comment\"> */</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JsonViews</span> <span class=\"token punctuation\">{</span>\n\t  <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Create</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Update</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Create</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Summary</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Update</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Admin</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Summary</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Le niveau “<strong>Create”</strong> correspond aux attributs visibles pour la création d’un objet, “<strong>Update”</strong> étend du filtre précédent et permettra de filtrer uniquement les attributs qui peuvent être mis à jour. <strong>“Summary”,</strong> étend des propriété de <strong>“Create”</strong> et <strong>”Update”.</strong> Enfin “<strong>Admin”</strong> permet de visualiser ou de mettre à jour des attributs uniquement accessibles aux Administrateurs.</p>\n<p>Cette fonctionnalité sert non seulement au rendu d’un JSON, que lorsque l’API consomme le Body d’une requête.</p>\n<p>Nous allons mettre à jour l’entité pour que les attributs soient filtrés correctement par l’API :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@MappedSuperclass</span>\n<span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token annotation punctuation\">@SuperBuilder</span>\n<span class=\"token annotation punctuation\">@NoArgsConstructor</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">EntityAbstract</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy<span class=\"token operator\">=</span><span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>AUTO<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Update</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Integer</span> id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@CreatedDate</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"timestamp default CURRENT_TIMESTAMP\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span>access <span class=\"token operator\">=</span> <span class=\"token class-name\">JsonProperty<span class=\"token punctuation\">.</span>Access</span><span class=\"token punctuation\">.</span>READ_ONLY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonFormat</span><span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token class-name\">JsonFormat<span class=\"token punctuation\">.</span>Shape</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">,</span> pattern<span class=\"token operator\">=</span><span class=\"token string\">\"yyyy-MM-dd'T'HH:mm:ss'Z'\"</span><span class=\"token punctuation\">,</span> timezone<span class=\"token operator\">=</span><span class=\"token string\">\"UTC\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Admin</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">LocalDateTime</span> createdAt<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@LastModifiedDate</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> columnDefinition <span class=\"token operator\">=</span> <span class=\"token string\">\"timestamp default CURRENT_TIMESTAMP\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span>access <span class=\"token operator\">=</span> <span class=\"token class-name\">JsonProperty<span class=\"token punctuation\">.</span>Access</span><span class=\"token punctuation\">.</span>READ_ONLY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonFormat</span><span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token class-name\">JsonFormat<span class=\"token punctuation\">.</span>Shape</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">,</span> pattern<span class=\"token operator\">=</span><span class=\"token string\">\"yyyy-MM-dd'T'HH:mm:ss'Z'\"</span><span class=\"token punctuation\">,</span> timezone<span class=\"token operator\">=</span><span class=\"token string\">\"UTC\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Admin</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">LocalDateTime</span> updatedAt<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Vehicle</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">EntityAbstract</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Create</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> registrationPlate<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Create</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> model<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Create</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> brand<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@NotEmpty</span>\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Create</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">String</span> serialNumber<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Enfin nous pouvons l’utiliser dans le controller :</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RestController</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">VehicleController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">VehicleService</span> vehicleService<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\">     * List véhicles</span>\n<span class=\"token doc-comment comment\">     */</span>\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/vehicle/list\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Summary</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&#x3C;</span><span class=\"token class-name\">Vehicle</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\">     * List vehicles (Admin)</span>\n<span class=\"token doc-comment comment\">     */</span>\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/vehicle/list\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Summary</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&#x3C;</span><span class=\"token class-name\">Vehicle</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">adminListVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">listVehicles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\">     * Create vehicle (Admin)</span>\n<span class=\"token doc-comment comment\">     */</span>\n    <span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/vehicle\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Admin</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Vehicle</span> <span class=\"token function\">postAdminVehicle</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Create</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Vehicle</span> vehicle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">createVehicle</span><span class=\"token punctuation\">(</span>vehicle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\">     * Update vehicle (Admin)</span>\n<span class=\"token doc-comment comment\">     */</span>\n    <span class=\"token annotation punctuation\">@PutMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/vehicle\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Admin</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Vehicle</span> <span class=\"token function\">putAdminVehicle</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@JsonView</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonViews<span class=\"token punctuation\">.</span>Update</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Vehicle</span> vehicle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> vehicleService<span class=\"token punctuation\">.</span><span class=\"token function\">updateVehicle</span><span class=\"token punctuation\">(</span>vehicle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h1>Résultat</h1>\n<h2>Liste des véhicules (Vue utilisateur)</h2>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">~ <span class=\"token function\">curl</span> http://localhost:8080/vehicle/list\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:1,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-205-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"205\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"3KX9YLH2K980HNYYS1YZ\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:2,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-206-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"206\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VST52ASAH145TIZGJ3LC\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:3,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-207-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"207\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"JI0BNW8D1HYGPFAECEPJ\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:4,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-208-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"208\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"LN97FF02UWRJYRAEGFL5\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:5,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-106-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"106\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"R94DJ8P5PT7M6PB5DP5B\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:6,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-107-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"107\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"OJHHEW2SP2KJDU3CZLFO\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:7,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-108-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"108\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"49LUMOTWMOQSNHK09MR3\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:8,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-306-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"306\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"0KBBBHVTZN9P66I8TVGT\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:9,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-307-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"307\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"TK0GX92MY29AR0H9ZYIB\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:10,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-308-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"308\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"EKNPA002KCQXYAUX04AV\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:11,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-309-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"309\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"D1788D08RU0AU3O5BVXR\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:12,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-405-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"405\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PHU0M7NKZ799D64VBVJ8\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:13,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-406-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"406\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"NAD3F2ULL5TY4QCECLAO\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:14,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-407-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"407\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"C842THXCOBFFZ0O5U0YK\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:15,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-508-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"508\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"F0T2ELSQ0VPRF1NBY8XH\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:16,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-407-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"407\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"WEBVP95ON3HDX0TGPFXB\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:17,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-508-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"508\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"TEZ3D70UDBY8UKHRKSYY\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:18,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-605-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"605\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"WIGYNFTWH0Q6E85Z2HA2\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:19,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-607-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"607\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"OLI3JCTF82WUQK14Z295\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n</code></pre></div>\n<h2>Liste des Véhicules (Vue Admin)</h2>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">~ <span class=\"token function\">curl</span> http://localhost:8080/admin/vehicle/list\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:1,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-205-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"205\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"3KX9YLH2K980HNYYS1YZ\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:2,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-206-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"206\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VST52ASAH145TIZGJ3LC\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:3,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-207-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"207\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"JI0BNW8D1HYGPFAECEPJ\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:4,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-208-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"208\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"LN97FF02UWRJYRAEGFL5\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:5,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-106-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"106\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"R94DJ8P5PT7M6PB5DP5B\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:6,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-107-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"107\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"OJHHEW2SP2KJDU3CZLFO\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:7,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-108-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"108\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"49LUMOTWMOQSNHK09MR3\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:8,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-306-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"306\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"0KBBBHVTZN9P66I8TVGT\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:9,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-307-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"307\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"TK0GX92MY29AR0H9ZYIB\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:10,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-308-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"308\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"EKNPA002KCQXYAUX04AV\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:11,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-309-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"309\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"D1788D08RU0AU3O5BVXR\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:12,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-405-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"405\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PHU0M7NKZ799D64VBVJ8\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:13,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-406-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"406\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"NAD3F2ULL5TY4QCECLAO\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:14,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-407-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"407\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"C842THXCOBFFZ0O5U0YK\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:15,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-508-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"508\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"F0T2ELSQ0VPRF1NBY8XH\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:16,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-407-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"407\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"WEBVP95ON3HDX0TGPFXB\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:17,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-508-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"508\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"TEZ3D70UDBY8UKHRKSYY\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:18,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-605-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"605\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"WIGYNFTWH0Q6E85Z2HA2\"</span><span class=\"token punctuation\">}</span>,<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:19,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T14:32:13Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"AA-607-AA\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"607\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"PEUGEOT\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"OLI3JCTF82WUQK14Z295\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n</code></pre></div>\n<h2>Création de véhicule</h2>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">~ <span class=\"token function\">curl</span> --location --request POST <span class=\"token string\">'localhost:8080/admin/vehicle'</span> <span class=\"token punctuation\">\\</span>\n--header <span class=\"token string\">'Content-Type: application/json'</span> <span class=\"token punctuation\">\\</span>\n--data-raw <span class=\"token string\">'{</span>\n<span class=\"token string\">    \"brand\": \"VolksWagen\",</span>\n<span class=\"token string\">    \"model\": \"Golf\",</span>\n<span class=\"token string\">    \"serialNumber\": \"VWVWVWVWVWVWVW\",</span>\n<span class=\"token string\">    \"registrationPlate\": \"GO-123-LF\"</span>\n<span class=\"token string\">}'</span>\n<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:20,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T15:34:03Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T15:34:03Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"GO-123-LF\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"Golf\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VolksWagen\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VWVWVWVWVWVWVW\"</span><span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2>Mise a jour de véhicule</h2>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">~ <span class=\"token function\">curl</span> --location --request PUT <span class=\"token string\">'localhost:8080/admin/vehicle'</span> <span class=\"token punctuation\">\\</span>\n--header <span class=\"token string\">'Content-Type: application/json'</span> <span class=\"token punctuation\">\\</span>\n--data-raw <span class=\"token string\">'{</span>\n<span class=\"token string\">    \"id\": 20,</span>\n<span class=\"token string\">    \"brand\": \"VolksWagen\",</span>\n<span class=\"token string\">    \"model\": \"Golf SW\",</span>\n<span class=\"token string\">    \"serialNumber\": \"VWVWVWVWVWVWVW\",</span>\n<span class=\"token string\">    \"registrationPlate\": \"GO-123-LF\"</span>\n<span class=\"token string\">}'</span>\n<span class=\"token punctuation\">{</span><span class=\"token string\">\"id\"</span>:20,<span class=\"token string\">\"createdAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T15:40:55Z\"</span>,<span class=\"token string\">\"updatedAt\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"2022-02-28T15:40:55Z\"</span>,<span class=\"token string\">\"registrationPlate\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"GO-123-LF\"</span>,<span class=\"token string\">\"model\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"Golf SW\"</span>,<span class=\"token string\">\"brand\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VolksWagen\"</span>,<span class=\"token string\">\"serialNumber\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"VWVWVWVWVWVWVW\"</span><span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Vous pouvez retrouver le github du projet ici : <a href=\"https://dev.to/giboow/springboot-contextualizing-serialization-29mp\">https://dev.to/giboow/springboot-contextualizing-serialization-29mp</a></p>\n<p>Crédit photo : https://unsplash.com/photos/WVl1N2C2zEA</p>\n","author":"giboow","title":"SpringBoot -  Contextualiser la serialisation","date":"2022-02-28","keywords":["SpringBoot","API","JSON","Jackson","Filter"],"image":"/static/images/post/tyler-nix-WVl1N2C2zEA-unsplash.jpg","summary":"À chaque fois que j’ai développé une API, je me suis confronté au même problème : comment filtrer les données","readingTime":4},{"id":"comment-transcoder-une-video-avec-springboot-et-ffmpeg","contentHtml":"<p>J'ai récemment commencé à travailler sur un système de caméras de surveillance et je souhaite pouvoir afficher les vidéos collectées sur des pages Web.\nÀ première vue, cela semblait très facile, mais je me suis vite rendu compte que je devais me creuser la tête!</p>\n<h1>Comment cela doit fonctionner?</h1>\n<p>La caméra est connectée à un NVR (Numeric Video recorder) qui possède une API permettant de récupérer les informations de configuration et le flux vidéo. En cherchant un peu sur le Web (Oui la documentation est difficile d'accès..), je découvre que le protocole de communication utilisé par le NVR est le RTSP (Real-Time Streaming Protocol). C'est là que je rencontre le principal problème ! Comment utiliser ce protocole dans une page HTML qui ne le supporte pas ? Ma solution est d'utiliser un serveur qui permet de transcoder la vidéo dans un format plus connu (MP4) et un protocole ultra standard (Http). Cela me permettra également de cacher les identifiants d'accès à la caméra en utilisant mon serveur comme un proxy.</p>\n<p><img src=\"https://giboow.fr/static/images/post/proxy-transcoder-ffmpeg/graph-ffmpeg-transcoder.png\" alt=\"Graph it should work\"></p>\n<h1>Alors comment on fait ça?</h1>\n<p>Un excellent outil bien connu pour faire de la conversion vidéo est <a href=\"https://www.ffmpeg.org/\">FFMPeg</a>, donc je commence à regarder comment je peux l'utiliser pour convertir RSTP. Je trouve rapidement une ligne de commande qui fonctionne :</p>\n<div class=\"remark-highlight\"><pre class=\"language-bash\"><code class=\"language-bash\">ffmpeg -y -loglevel level+info -n -re -acodec pcm_s16le -rtsp_transport tcp -i rtsp://user:passwd@192.168.1.200:554/ISAPI/Streaming/channels/101/live -vcodec copy -af <span class=\"token assign-left variable\">asetrate</span><span class=\"token operator\">=</span><span class=\"token number\">22050</span> -acodec aac -b:a 96k -nostdin myvideo.mp4\n</code></pre></div>\n<p>Alors comment faire un proxy avec SpringBoot ? C'est très simple en fait, il suffit d'utiliser l'objet <a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/mvc/method/annotation/StreamingResponseBody.html\">StreamingResponseBody</a>. Cela permet de renvoyer un traitement asynchrone de la requête, où l'application peut écrire directement sur le flux de sortie de la réponse sans bloquer le reste de mon API.</p>\n<p>Enfin, il me suffit d'utiliser FFMPEG dans mon contrôleur pour envoyer le flux via mon API. J'aurais pu utiliser \" Runtime.getRuntime().exec(\" ffmpeg...) \" mais je n'arrivais pas à trouver comment obtenir mon flux. Heureusement, j'ai trouvé une bibliothèque magique <a href=\"https://github.com/kokorin/Jaffree\">Jaffree</a> : \"Jaffree stands for JAva FFmpeg and FFprobe FREE command line wrapper. Jaffree supports programmatic video production and consumption (with transparency)\"</p>\n<h1>La solution</h1>\n<p>Voici la solution finale et comment relayer un flux vidéo provenant d'une caméra HikVision afin que le format soit utilisable par une page HTML.</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>kokorin<span class=\"token punctuation\">.</span>jaffree<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamType</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>kokorin<span class=\"token punctuation\">.</span>jaffree<span class=\"token punctuation\">.</span>ffmpeg<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">FFmpeg</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>github<span class=\"token punctuation\">.</span>kokorin<span class=\"token punctuation\">.</span>jaffree<span class=\"token punctuation\">.</span>ffmpeg<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">PipeOutput</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@RestController</span>\n<span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/video\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@Log4j2</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">VideoController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"/live.mp4\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@ResponseBody</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&#x3C;</span><span class=\"token class-name\">StreamingResponseBody</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">livestream</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@PathVariable</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> tipperId<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token class-name\">String</span> rtspUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"rtsp://user:passwd@192.168.1.200:554/ISAPI/Streaming/channels/101/live\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token punctuation\">.</span><span class=\"token function\">ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">contentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span>APPLICATION_OCTET_STREAM<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">body</span><span class=\"token punctuation\">(</span>os <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token class-name\">FFmpeg</span><span class=\"token punctuation\">.</span><span class=\"token function\">atPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArgument</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-re\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-acodec\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pcm_s16le\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-rtsp_transport\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tcp\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-i\"</span><span class=\"token punctuation\">,</span> $rtspUrl<span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-vcodec\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"copy\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-af\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"asetrate=22050\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-acodec\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"aac\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArguments</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-b:a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"96k\"</span> <span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addOutput</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PipeOutput</span><span class=\"token punctuation\">.</span><span class=\"token function\">pumpTo</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">disableStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamType</span><span class=\"token punctuation\">.</span>AUDIO<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">disableStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamType</span><span class=\"token punctuation\">.</span>SUBTITLE<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">disableStream</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamType</span><span class=\"token punctuation\">.</span>DATA<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">setFrameCount</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamType</span><span class=\"token punctuation\">.</span>VIDEO<span class=\"token punctuation\">,</span> <span class=\"token number\">100L</span><span class=\"token punctuation\">)</span>\n                                     <span class=\"token comment\">//1 frame every 10 seconds</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">setFrameRate</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">setDuration</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">TimeUnit</span><span class=\"token punctuation\">.</span>HOURS<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">.</span><span class=\"token function\">setFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ismv\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">addArgument</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-nostdin\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Vous devrez également modifier la configuration de votre application SpringBoot (fichier application.properties) pour augmenter le délai d'attente pour les requêtes asynchrones.</p>\n<div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\">spring.mvc.async.request-timeout = 3600000\n</code></pre></div>\n<p>Il vous suffit d'appeler votre API sur la page web :</p>\n<div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>video<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>video</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100%<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>auto<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">controls</span> <span class=\"token attr-name\">autoplay</span> <span class=\"token attr-name\">muted</span> <span class=\"token attr-name\">loop</span> <span class=\"token attr-name\">*ngIf</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>event?.video<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://localhost:8080/video/live.mp4<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>video/mp4<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    Sorry, your browser doesn't support embedded videos.\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;/</span>video</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;/</span>div</span><span class=\"token punctuation\">></span></span>\n</code></pre></div>\n<p>Et voici le résultat :</p>\n<p><img src=\"https://giboow.fr/static/images/post/proxy-transcoder-ffmpeg/result-ffmpeg-transcoder.png\" alt=\"Final result\"></p>\n<p>Facile non?</p>\n<p><a href=\"https://dev.to/giboow/how-to-build-a-video-transcoder-with-springboot-and-ffmpeg-n7p\">Retrouvez l'article anglais sur dev.to</a></p>\n","author":"giboow","title":"Comment construire un transcodeur vidéo avec SpringBoot et FFMPEG !","date":"2021-10-12","keywords":["Video","Transcoder","SpringBoot","FFMpeg","Java"],"image":"/static/images/post/proxy-transcoder-ffmpeg/main.jpg","summary":"J'ai récemment commencé à travailler sur un système de caméras de surveillance et je souhaite pouvoir afficher les vidéos collectées sur des pages Web. À première vue, cela semblait très facile...","readingTime":3},{"id":"android-emulator-apple-silicon","contentHtml":"<p>Bonsoir à tous!</p>\n<p>J'ai récemment craqué pour le nouveau MacBook Pro M1! Depuis 1 semaine que je l'apprivoise, toutes les applications\nque j'utilise fonctionnent (merci Rosetta2!). Mon seul problème, en tant que developpeur mobile, est que l'Emulateur\nAndroid ne fonctionne pas. C'est\nd'ailleurs le problème de toutes les applications qui font de la virtualisation (Docker, ParallelDesktop, etc …)!\nJe dois donc utiliser un téléphone physique, et cela m'empêche de tester mes applications sur différentes versions\nd'Android.</p>\n<p>Heureusement les ingénieurs de Google sont à fond sur le  coup et ont mis à disposition une version Preview de\nl'émulateur ici : <a href=\"https://androidstudio.googleblog.com/2020/12/android-emulator-apple-silicon-preview.html\">https://androidstudio.googleblog.com/2020/12/android-emulator-apple-silicon-preview.html</a></p>\n<p>Et ça fonctionne :</p>\n<p><img src=\"/static/images/post/capture_android_emulator_preview.png\" alt=\"Capture Android preview\"></p>\n<p>Pour autant tout n'est pas parfait :</p>\n<ul>\n<li>Les Webview ne fonctionnent pas</li>\n<li>Pas de son</li>\n<li>Pas de skin téléphone</li>\n<li>Les codecs vidéos ne sont pas fonctionnels</li>\n<li>Les applications ARM 32Bits ne sont pas compatibles</li>\n<li>Quelques bugs graphiques sur les applications utilisant l'API Vulkan</li>\n<li>Une popup apparait au démarrage de l'émulateur, indiquant qu'elle ne trouve pas ADB</li>\n</ul>\n<p>Tout est dit! Il ne reste plus qu'à tester 😃.</p>\n<p>Amusez-vous bien!</p>\n","author":"giboow","title":"Android Emulator sur Apple Silicon, enfin une preview!","date":"2020-12-06","keywords":["Android","Android Emulator","Apple Silicon","AppleM1"],"image":"/static/images/post/android-apple.png","summary":"J'ai récemment craqué pour le nouveau MacBook Pro M1! Depuis 1 semaine que je l'apprivoise, toutes les applications que j'utilise fonctionnent (merci Rosetta2!). Mon seul problème, en tant que developpeur mobile, est que l'Emulateur Android ne fonctionne pas","readingTime":1},{"id":"comment-configurer-postgresql-avec-pgtune","contentHtml":"<p>Récemment, j'ai dû mettre le nez dans les serveurs de notre application, car nous avions des problèmes de performances\net de stabilité.</p>\n<p>Pour vous replanter le décor, l'application dont je m'occupe aujourd'hui est hébergé sur un serveur qui comprend un\nservice de base de données Postgres, un serveur d'application Java, ainsi que d'un serveur apache permettant aux\nutilisateurs de télécharger le front. Tout ça fonctionne sur le même serveur sans conteneurs. N'ayant pas installé ces\nservices moi-même, j'ai dû passer un peu de temps pour comprendre pourquoi notre serveur plantait lors de fortes\ncharges... Puis je me suis aperçu grâce à notre système de monitoring que la mémoire du serveur Postgres n'était même\npas limitée...</p>\n<p>Je n'ai aucune connaissance sur les configurations des services Postgres, et comme je n'aime pas trop perdre de temps à\néplucher les documentations, j'ai fouillé un peu sur la toile. C'est là que j'ai découvert le travail\nde <a href=\"https://github.com/le0pard\">Alexey Vasiliev (@leOpard)</a> qui propose un générateur de configuration\nPostgres : <a href=\"https://pgtune.leopard.in.ua/#/\">PGTune</a></p>\n<p>Il suffit de paramétrer votre configuration en fonction des ressources que vous voulez allouer sur le serveur! Et PAF ça\nfait le ☕!</p>\n<p><img src=\"/static/images/post/capture-pgtune.png\" alt=\"PGTune capture\"></p>\n<p>Il ne vous reste plus qu'à injecter cette nouvelle configuration dans le fichier de configuration de votre Postgres.</p>\n<p>Depuis que j'ai appliqué la configuration par l'utilitaire, je n'ai plus de problème de performance. Finalement, les utilisateurs sont\ncontents, et moi aussi 😃.</p>\n<p>Pour les fans de <a href=\"https://www.ruby-lang.org/fr/\">Ruby</a>, où si cela vous amuse, vous pouvez aller consulter le code du\ngénérateur de @leOpard, les sources sont disponibles sur\nGithub : <a href=\"https://github.com/le0pard/pgtune\">https://github.com/le0pard/pgtune</a></p>\n","author":"giboow","title":"Comment bien configurer son serveur Postgres avec PGTune","date":"2020-12-02","keywords":["Postgresql","Tunning","Performances"],"image":"/static/images/post/pgtune.png","summary":"Présentation d'un outils qui permet de configurer simplement un serveur PostgreSQL","readingTime":2},{"id":"giboow-le-blog","contentHtml":"<p>Je m'appelle Philippe, j'ai 36 ans, j'ai une petite famille ainsi qu'un chat et deux poules!\nJe suis développeur d'application depuis une bonne quinzaine d'années. Le développement et la technologie occupent donc\nune bonne partie de mes journées !</p>\n<p>J'ai toujours aimé la programmation et la logique qui en découle. J'ai commencé ma carrière au collège en 4e, lorsque\nmon grand frère m'a offert une calculatrice Casio graphique, depuis ce jour là j'ai découvert les bases de la\nprogrammation ! À 13 ans, nous avons reçu notre premier ordinateur, c'était un Apple Performa 6320, au bout d’un mois\nnous avons démonté la bête avec mon frère pour voir comment cela fonctionnait !\nJ'ai ensuite continué mon évolution tranquillement avec des pages HTML statiques, des Apple script, etc...</p>\n<p>Pendant mes\nétudes j'ai beaucoup travaillé sur Linux j'ai donc une bonne connaissance de ce système et de son fonctionnement, je ne\nsuis cependant pas un expert (mais je me débrouille toujours 😃).</p>\n<p>En 2009, j'ai commencé ma carrière professionnelle. J'ai toujours voulu naviguer sur différents projets, apprendre de\nnouvelles choses. Je déteste le fait d'être considéré comme un expert dans une technologie précise. J'aime apprendre de\nnouvelles choses, maitriser l'ensemble de mes projets, et de partager mes connaissances avec mes amis, mes collègues,\nvous !</p>\n<p>Sur ce blog conçut et réaliser avec ♥, je vais essayer de vous partager mon quotidien (du code, du code, du code!!),\nmais aussi tout ce que je trouve intéressant sur la toile et relatif a mon métier (application, librairies, hardware,\nnews, etc.) !</p>\n<p>Ce site va être aussi pour moi, un bon moyen pour (re)découvrir ReactJs ainsi que NextJs. J'ai en effet eu l'occasion de\nmanipuler ces deux frameworks, mais sans jamais proposer une version disponible publiquement.</p>\n","author":"giboow","title":"Giboow, le Blog!","date":"2020-11-25","keywords":["Blog","TheBeginning","Objectifs"],"image":"/static/images/post/hello-image.webp","summary":"Je m'appelle Philippe, j'ai 36 ans, j'ai une petite famille ainsi qu'un chat et deux poules! Je suis développeur d'application","readingTime":2}]},"__N_SSG":true}